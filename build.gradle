defaultTasks 'clean', 'check', 'publishToMavenLocal'

ext {
  commonsLangVersion = '3.14.0'
  netty4Version = '4.1.104.Final'
  commonsTextVersion = '1.11.0'
  slf4jVersion = '2.0.11'
  assertjVersion = '3.25.1'
  mockitoVersion = '5.8.0'
  pdfTestVersion = '1.8.1'
  groovyVersion = '3.0.20'
  httpclientVersion = '4.5.14'
  restAssuredVersion = '5.4.0'
  junitVersion = '5.10.1'
}

subprojects {

  group='io.github.replay-framework'
  version=project.properties['revision'] ?: '2.3.1'

  apply plugin: 'java'
  apply plugin: 'java-library'

  [compileJava, compileTestJava]*.options.collect {options ->
    options.encoding = 'UTF-8'
    options.compilerArgs << '-parameters'
    options.debug = true
    options.debugOptions.debugLevel = "source,lines,vars"
  }
  java.toolchain {
    languageVersion = JavaLanguageVersion.of(11)
  }

  repositories {
    mavenCentral()
    mavenLocal()
  }

  sourceSets {
    main {
      java {
        srcDir 'src'
        include '**/*.java'
        include '**/*.kt'
      }
      resources {
        srcDir 'src'
        exclude '**/*.java'
        exclude '**/*.kt'
      }
    }
    test {
      java {
        srcDir 'test'
        include '**/*.java'
        include '**/*.kt'
      }
      resources {
        srcDir 'test'
        exclude '**/*.java'
        exclude '**/*.kt'
      }
    }
  }


  test {
    include 'play/**/*'
  }

  tasks.withType(Test).configureEach { testTask ->
    useJUnitPlatform()
    testTask.systemProperties['file.encoding'] = 'UTF-8'
    testTask.systemProperties['user.country'] = 'TR'
    testTask.systemProperties['user.language'] = 'tr'
    testTask.testLogging {exceptionFormat = 'full'}
    testTask.outputs.upToDateWhen { false }
  }
  
  dependencies {
    testImplementation("org.junit.jupiter:junit-jupiter-api:$junitVersion")
    testImplementation("org.junit.jupiter:junit-jupiter-params:$junitVersion")
    testRuntimeOnly("org.junit.jupiter:junit-jupiter-engine:$junitVersion")
    testImplementation("org.mockito:mockito-core:$mockitoVersion")
    testImplementation("org.assertj:assertj-core:$assertjVersion")
  }
}
